//*********  Version: 13 November 2024 15:28  *******
@NrDigits: 12  // number of decimal places in reaction coefficients. 
 //@rewriteReactions:   //indicates that reactions are rewritten in terms of primary entities. 
 //@include_molar_volume_parameters:   //include molar volume parameters from phreeqc database in species definitions. 

//********* The database file(s) *******
// This section lists the database files that are used by the interactive chemistry editor
// The database file is not used during the calculations!
// Syntax for local files:                   @database: minteq.txt
// Syntax for files on the internet:         @database: www.meeussen.nl/orchestra/minteqv4.txt

@database: kinetics_db.txt
@database: adsmodels2022.txt
@database: minteq.v4_2021.txt
@database: mydatabase.txt
//********* End of the database file(s) *******


//********* Extra text 0 *******

@class: extra_text_0(){
  // Here is some space for extra code that will be used in the calculations but will not be changed by the GUI.
  @scan: objects2024.txt
  @scan: kinetics_db.txt
  @stop:
}
@extra_text_0()
//********* End of extra text 0 *******


//********* The variables *******
@Var: CLAY_kgkg .0003 // Clay kg per kg solid fraction
@Var: DFA_kgl 0.0 // Dissolved fulvic acid kg/l
@Var: DHA_kgl 0.0 // Dissoved humic acid kg/l
@Var: E.logact 1 // 
@Var: FA_kgkg 0 // 
@Var: Goethite_kgkg 0.0 // 
@Var: H+.logact 1.0 // 
@Var: H.logact 1 // 
@GlobalVar: H2O.logact 0.0 // 
@Var: HA_kgkg 1.0E-4 // 
@Var: HFO_kgkg 1e-3 // 
@GlobalVar: I .1 // 
@Var: O.logact 1 // 
@Var: R 0.082057366080960 // gas constant L atm / (mol K)
@Var: SL 1.0 // 
@Var: T 298.15 // Temperature in degrees Kelvin
@Var: Waste_kgkg .04 // 
@Var: density 1.5 // 
@Var: e-.logact 1.0 // 
@Var: gasvolume 1 // 
@Var: gasvolume_fixed 1 // 
@Var: pH 7 // 
@Var: pe 3.0 // 
@Var: porosity .7 // 
@Var: pressure 1 // 
@Var: pressure_fixed 1 // 
@Var: saturation .711 // 
@Var: totvolume 2 // 
@Var: watervolume 1 // 
//********* End of the variables *******


//********* Extra text 1 *******
@class: extra_text_1(){
  // Here you can write ORCHESTRA extra expressions new style.
  @Calc: (1, "totvolume = watervolume + gasvolume")     // is total volume per cell
  //@Calc: (1, "gasvolume   = porosity * (1-saturation)")             // is tot gas volume per liter water
  //@Calc: (1, "SL = ((1-porosity)*density) / (porosity*saturation)")

  // We want to be able to work with either a fixed_volume or a fixed_pressure
  @Var: gas_type 0 // gastype: fixed_volume = 0 or fixed_pressure = 1

  // We introduce two variables:

  @Var: gas_u  25  // the "unknown" that is directly estimated by the solver and can be used as input for all other calculations
  @Var: gas_res 0  // the "equation" that is calculated from the chemical equilibrium condition, and should go to zero.

  //@Var: pressure_u  4  // the "unknown" that is directly estimated by the solver and can be used as input for all other calculations
  //@Var: pressure_res 0  // the "equation" that is calculated from the chemical equilibrium condition, and should go to zero.

  // We introduce extra expressions in three steps:

  // In the first step we calculate the gasvolume from the unknown (0 if unknown is negative)
  // This calculation is defined during stage 1, so before all other calculations and we can thus use
  // the gasvolume as input in the rest of the chemistry
  @Calc: (1, "gasvolume = if(gas_type==0, gasvolume_fixed, if(gas_u>0, gas_u, 0))")

  // In the second step we calculate the pressure using
  //	fixed_volume: the sum of the logact values of the species present in the gas-phase.
  //    fixed_pressure: the predefined pressure: pressure_fixed
  @Calc: (5, "pressure = if(gas_type==0, {CO2[g].con} + {Ar[g].con}, pressure_fixed)")
  //@Calc: (1, "pressure = if(gas_type==1, pressure_fixed, pressure_u)"

  // In the third step we define the the equation(s) that should go to zero.
  // It is defined during stage 5, so after all other chemical calculations are ready.
  // Effectively:
  // the sum of partial pressures will equal the total pressure when the unknown/gasvolume is greater than zero,
  // the sum of partial pressures will be less than the total pressure, when the unknown is less than zero.
  @Calc: (5, "gas_res = if(gas_type==0, pressure - ({CO2[g].con} + {Ar[g].con}),0))"
  //@Calc: (5, "pressure_res = if(gas_type==1, 0, pressure - ({CO2[g].con} + {Ar[g].con})))"
	
  // Now we just have to define that the unknown/equation has to be solved as part of the iteration procedure.
  //@solve: unknown:(name:, gas_u, type:, lin, step:, 1) equation:(name:, gas_res)
  //@solve: unknown:(name:, pressure_u, delta:, 1e-3, type:, lin, step:, 1) equation:(name:, pressure_res)

}
@extra_text_1()
//********* End of extra text 1 *******

//********* The phases *******
@phase(tot)
@phase(liter)
@link_phase(liter, tot, "watervolume")
@phase(solution)
@link_phase(solution, liter, "1")
@phase(diss)
@link_phase(diss, solution, "1")
@phase(colloid)
@link_phase(colloid, solution, "1")
@phase(DHA_part)
@link_phase(DHA_part, colloid, "1")
@phase(DFA_part)
@link_phase(DFA_part, colloid, "1")
@phase(solid)
@link_phase(solid, liter, "1")
@phase(min)
@link_phase(min, solid, "1")
@phase(ads)
@link_phase(ads, solid, "1")
@phase(CLAY_part_l)
@link_phase(CLAY_part_l, ads, "1")
@phase(CLAY_part)
@link_phase(CLAY_part, CLAY_part_l, "CLAY_kgkg*SL")
@phase(HFO_part_l)
@link_phase(HFO_part_l, ads, "1")
@phase(HFO_part)
@link_phase(HFO_part, HFO_part_l, "HFO_kgkg*SL")
@phase(Goethite_part_l)
@link_phase(Goethite_part_l, ads, "1")
@phase(Goethite_part)
@link_phase(Goethite_part, Goethite_part_l, "Goethite_kgkg*SL")
@phase(SHA_part_l)
@link_phase(SHA_part_l, ads, "1")
@phase(HA_part)
@link_phase(HA_part, DHA_part, "DHA_kgl")
@link_phase(HA_part, SHA_part_l, "HA_kgkg*SL")
@phase(SFA_part_l)
@link_phase(SFA_part_l, ads, "1")
@phase(FA_part)
@link_phase(FA_part, DFA_part, "DFA_kgl")
@link_phase(FA_part, SFA_part_l, "FA_kgkg*SL")
@phase(gas_l)
@link_phase(gas_l, liter, "gasvolume/watervolume")
@phase(gas)
@link_phase(gas, gas_l, "gasvolume /(R*T)")
@end_of_gui_phases:
//********* End of the phases *******

//********* Extra text 2 *******
@class: extra_text_2(){
   @include: objects2022.txt
}
@extra_text_2()
//********* End of extra text 2 *******

@globalvar: I .1
@davies()

//********* The primary entities *******
@balance_charge(pH)
@gas(Ar[g])
@primary_entity(Ar[g], -9.0, tot, 1.0E-9)
@gas(CO2[g])
@primary_entity(CO2[g], -9.0, tot, 1.0E-9)
@Global: pH
@Calc:(1, "H.logact = -pH")
@entity(H, tot, 0)
@primary_entity(H, pH, 7.0)
@entity(H2O, liter, 55.6)
@primary_entity(H2O, -0.0)
//****************************************
//******************************

//********* Extra text 2a **************
@class: extra_text_2a(){

 // Here is some space for extra code that will be used in the calculations but will not be changed by the GUI. 
}
@extra_text_2a()
//********* End of extra text 2a *******

//********* The entities *******

@species(H+, 1)
@logKreaction(H+, 0.0, 1.0, H)
@species(CO3-2, -2)
@logKreaction(CO3-2, "-(-1 * (( (1.0 / log(10)) * ((-18.147 * log(10)) - (4059.9999999999995 / 8.3144598) * ((1 / @T()) - (1 / 298.15))) )))", 1.0, CO2[g], -2.0, H+, 1.0, H2O)
@entity(Alkalinity, tot, 0)
@logKreaction(Alkalinity, "-(0)", 1.0, CO3-2)
@species(Ar, 0)
@logKreaction(Ar, -20.0, 1.0, Ar[g])
@entity(C, tot, 0)
@logKreaction(C, "-(0)", 1.0, CO3-2)
@entity(C[+4], tot, 0)
@logKreaction(C[+4], "-(0)", 1.0, CO3-2)
@species(H2CO3, 0, 0, 0)
@logKreaction(H2CO3, "(( (1.0 / log(10)) * ((16.681 * log(10)) - (-23760.0 / 8.3144598) * ((1 / @T()) - (1 / 298.15))) ))", 1.0, CO3-2, 2.0, H+)
@gas(H2O[g])
@logKreaction(H2O[g], "-1 * (( (1.0 / log(10)) * ((1.506 * log(10)) - (-44004.0 / 8.3144598) * ((1 / @T()) - (1 / 298.15))) ))", 1.0, H2O)
@species(HCO3-, -1, 5.4, 0)
@logKreaction(HCO3-, "(( (1.0 / log(10)) * ((10.329 * log(10)) - (-14600.0 / 8.3144598) * ((1 / @T()) - (1 / 298.15))) ))", 1.0, CO3-2, 1.0, H+)
@entity(H[+1], tot, 0)
@logKreaction(H[+1], 0.0, 1.0, H)
@entity(O, tot, 0)
@logKreaction(O, -0.0, 1.0, H2O)
@species(OH-, -1, 3.5, 0)
@logKreaction(OH-, -14.096381591995634, -1.0, H, 1.0, H2O)
@entity(O[-2], tot, 0)
@logKreaction(O[-2], -0.0, 1.0, H2O)
//********* Extra text 3 **************
@class: extra_text_3(){
 // Here you can put some arbitrary extra code.   
}
@extra_text_3()
//********* End of extra text 3 *******

//********* Extra text 4 **************
@class: extra_text_4(){
 // Here you can write ORCHESTRA code that will be used in the calculations, but will not be interpreted by the GUI.  
}
@extra_text_4()
//********* End of extra text 4 *******

//********* End of Adsorption Models *******
//********* Extra text 5 **************
@class: extra_text_5(){
 // Here you can write ORCHESTRA code that will be used in the calculations, but will not be interpreted by the GUI.  
}
@extra_text_5()
//********* End of extra text 5 *******

//********* Write SI_minerals ************************* 
@Write_SI_minerals:
//*************************************************** 
//@PHREEQC_Output:
